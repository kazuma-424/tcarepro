<br>
<br>
<br>
<br>
<table class="header-table space" width="90%">
  <tr>
    <th colspan="6">時間別コール</th>
  </tr>
  <tr>
    <th></th>
    <th>不在率</th>
    <th>担当不在率</th>
    <th>見込率</th>
    <th>APP率</th>
    <th>NG率</th>
  </tr>
  <tr>
    <th>09:00~10:00</th>
    <td><%= number_to_percentage(@call_called_9.to_f / @call_total_9.to_f * 100, precision: 1) %>
      （<%= number_to_percentage(@call_called_b9.to_f / @call_total_b9.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_absence_9.to_f / @call_total_9.to_f * 100, precision: 1) %>
      （<%= number_to_percentage(@call_absence_b9.to_f / @call_total_b9.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_prospect_9.to_f / @call_total_9.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_prospect_b9.to_f / @call_total_b9.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_app_9.to_f / @call_total_9.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_app_b9.to_f / @call_total_b9.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_ng_9.to_f / @call_total_9.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_ng_b9.to_f / @call_total_b9.to_f * 100, precision: 1) %>）</td>
  </tr>
  <tr>
    <th>10:00~11:00</th>
    <td><%= number_to_percentage(@call_called_10.to_f / @call_total_10.to_f * 100, precision: 1) %>
      （<%= number_to_percentage(@call_called_b10.to_f / @call_total_b10.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_absence_10.to_f / @call_total_10.to_f * 100, precision: 1) %>
      （<%= number_to_percentage(@call_absence_b10.to_f / @call_total_b10.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_prospect_10.to_f / @call_total_10.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_prospect_b10.to_f / @call_total_b10.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_app_10.to_f / @call_total_10.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_app_b10.to_f / @call_total_b10.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_ng_10.to_f / @call_total_10.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_ng_b10.to_f / @call_total_b10.to_f * 100, precision: 1) %>）</td>
  </tr>
  <tr>
    <th>11:00~12:00</th>
    <td><%= number_to_percentage(@call_called_11.to_f / @call_total_11.to_f * 100, precision: 1) %>
      （<%= number_to_percentage(@call_called_b11.to_f / @call_total_b11.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_absence_11.to_f / @call_total_11.to_f * 100, precision: 1) %>
      （<%= number_to_percentage(@call_absence_b11.to_f / @call_total_b11.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_prospect_11.to_f / @call_total_11.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_prospect_b11.to_f / @call_total_b11.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_app_11.to_f / @call_total_11.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_app_b11.to_f / @call_total_b11.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_ng_11.to_f / @call_total_11.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_ng_b11.to_f / @call_total_b11.to_f * 100, precision: 1) %>）</td>
  </tr>
  <tr>
    <th>13:00~14:00</th>
    <td><%= number_to_percentage(@call_called_13.to_f / @call_total_13.to_f * 100, precision: 1) %>
      （<%= number_to_percentage(@call_called_b13.to_f / @call_total_b13.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_absence_13.to_f / @call_total_13.to_f * 100, precision: 1) %>
      （<%= number_to_percentage(@call_absence_b13.to_f / @call_total_b13.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_prospect_13.to_f / @call_total_13.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_prospect_b13.to_f / @call_total_b13.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_app_13.to_f / @call_total_13.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_app_b13.to_f / @call_total_b13.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_ng_13.to_f / @call_total_13.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_ng_b13.to_f / @call_total_b13.to_f * 100, precision: 1) %>）</td>
  </tr>
  <tr>
    <th>14:00~15:00</th>
    <td><%= number_to_percentage(@call_called_14.to_f / @call_total_14.to_f * 100, precision: 1) %>
      （<%= number_to_percentage(@call_called_b14.to_f / @call_total_b14.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_absence_14.to_f / @call_total_14.to_f * 100, precision: 1) %>
      （<%= number_to_percentage(@call_absence_b14.to_f / @call_total_b14.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_prospect_14.to_f / @call_total_14.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_prospect_b14.to_f / @call_total_b14.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_app_14.to_f / @call_total_14.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_app_b14.to_f / @call_total_b14.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_ng_14.to_f / @call_total_14.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_ng_b14.to_f / @call_total_b14.to_f * 100, precision: 1) %>）</td>
  </tr>
  <tr>
    <th>15:00~16:00</th>
     <td><%= number_to_percentage(@call_called_15.to_f / @call_total_15.to_f * 100, precision: 1) %>
      （<%= number_to_percentage(@call_called_b15.to_f / @call_total_b15.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_absence_15.to_f / @call_total_15.to_f * 100, precision: 1) %>
      （<%= number_to_percentage(@call_absence_b15.to_f / @call_total_b15.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_prospect_15.to_f / @call_total_15.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_prospect_b15.to_f / @call_total_b15.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_app_15.to_f / @call_total_15.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_app_b15.to_f / @call_total_b15.to_f * 100, precision: 1) %>）</td>
     <td><%= number_to_percentage(@call_ng_15.to_f / @call_total_15.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_ng_b15.to_f / @call_total_b15.to_f * 100, precision: 1) %>）</td>
  </tr>
  <tr>
    <th>16:00~17:00</th>
    <td><%= number_to_percentage(@call_called_16.to_f / @call_total_16.to_f * 100, precision: 1) %>
      （<%= number_to_percentage(@call_called_b16.to_f / @call_total_b16.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_absence_16.to_f / @call_total_16.to_f * 100, precision: 1) %>
      （<%= number_to_percentage(@call_absence_b16.to_f / @call_total_b16.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_prospect_16.to_f / @call_total_16.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_prospect_b16.to_f / @call_total_b16.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_app_16.to_f / @call_total_16.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_app_b16.to_f / @call_total_b16.to_f * 100, precision: 1) %>）</td>
   <td><%= number_to_percentage(@call_ng_16.to_f / @call_total_16.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_ng_b16.to_f / @call_total_b16.to_f * 100, precision: 1) %>）</td>
  </tr>
  <tr>
    <th>17:00~18:00</th>
    <td><%= number_to_percentage(@call_called_17.to_f / @call_total_17.to_f * 100, precision: 1) %>
      （<%= number_to_percentage(@call_called_b17.to_f / @call_total_b17.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_absence_17.to_f / @call_total_17.to_f * 100, precision: 1) %>
      （<%= number_to_percentage(@call_absence_b17.to_f / @call_total_b17.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_prospect_17.to_f / @call_total_17.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_prospect_b17.to_f / @call_total_b17.to_f * 100, precision: 1) %>）</td>
    <td><%= number_to_percentage(@call_app_17.to_f / @call_total_17.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_app_b17.to_f / @call_total_b17.to_f * 100, precision: 1) %>）</td>
     <td><%= number_to_percentage(@call_ng_17.to_f / @call_total_17.to_f * 100, precision: 1) %>
    　（<%= number_to_percentage(@call_ng_b17.to_f / @call_total_b17.to_f * 100, precision: 1) %>）</td>
  </tr>
</table>
<br>
<br>
<br>
<br>
<table class="header-table space" width="90%">
  <tr>
    <th colspan="11">スタッフ&シェアフル時間別コール</th>
  </tr>
  <tr>
    <th></th>
    <th>09:00~</th>
    <th>10:00~</th>
    <th>11:00~</th>
    <th>13:00~</th>
    <th>14:00~</th>
    <th>15:00~</th>
    <th>16:00~</th>
  </tr>
  <% @users.each do |user| %>
  <% user_total_calls = user.calls.where('created_at > ?', Time.current.beginning_of_day).where('created_at < ?', Time.current.end_of_day).to_a %>
  <tr>
    <th><%= user.user_name %></th>
    <td><%= user_total_calls.select { |call| l(call.created_at, format: :prepare) >= "09:00:00" }.select { |call| l(call.created_at, format: :prepare) < "09:59:59" }.count %></td>
    <td><%= user_total_calls.select { |call| l(call.created_at, format: :prepare) >= "10:00:00" }.select { |call| l(call.created_at, format: :prepare) < "10:59:59" }.count %></td>
    <td><%= user_total_calls.select { |call| l(call.created_at, format: :prepare) >= "11:00:00" }.select { |call| l(call.created_at, format: :prepare) < "11:59:59" }.count %></td>
    <td><%= user_total_calls.select { |call| l(call.created_at, format: :prepare) >= "13:00:00" }.select { |call| l(call.created_at, format: :prepare) < "13:59:59" }.count %></td>
    <td><%= user_total_calls.select { |call| l(call.created_at, format: :prepare) >= "14:00:00" }.select { |call| l(call.created_at, format: :prepare) < "14:59:59" }.count %></td>
    <td><%= user_total_calls.select { |call| l(call.created_at, format: :prepare) >= "15:00:00" }.select { |call| l(call.created_at, format: :prepare) < "15:59:59" }.count %></td>
    <td><%= user_total_calls.select { |call| l(call.created_at, format: :prepare) >= "16:00:00" }.select { |call| l(call.created_at, format: :prepare) < "16:59:59" }.count %></td>
  </tr>
  <% end %>
</table>
<br>
<br>
<br>
<br>
